---
title: "1209-rag1"
output: html_document
date: "2025-02-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
```

```{r}
library(ape)
library(tidyverse)
```

Reconstructing genes from the data

rag1


>EF095648.1 Lates calcarifer recombination-activating protein 1 (RAG1) gene, partial cds
CAGATATTTCAGCCCCTGCACACCCTCCGAGCTGCGGAGAAGGAGCTTCTCCCTGGCTTTCACCAGTTTG
AGTGGCAGCCAGCTCTCAAGAATGTGTCCACGTCTTGCAACGTTGGCATTATTAATGGGCTCTCTGGATG
GGCTGCCTCGCTGGATGACTCCCCGGCCGACACCATCACTCGGCGGTTTCGCTATGATGTGGCACTGGTG
TCAGCATTAAAAGATCTGGAGGAGGACATCATGGAGGGGCTGAGAGAGAGTGGGATGGAAGACAGCGCTT
GCACCTCAGGCTTTAGTGTCATGATCAAGGAATGTTGTGATGGCATGGGTGATGTCAGTGAAAAACACGG
TGGAGGACCAGCCGTTCCTGAGAAGGCTGTACGCTTCTCTTTCACCGTTATGTCTGTCTCTGTCCTGGCA
GATGACGACAGGCGGGAGGTTACCATCTTCACCGAGCCAAAGCCCAACTCAGAGCTGTCCTGTAAGCCCC
TTTGCCTGATGTTTGTGGATGAGTCAGACCATGAGACACTCACAGCTGTCCTGGGGCCTATAATAGCAGA
GCGTAACGCAATGAAAGAGAGCAGGCTCATCCTACCCATAGGAGGCCTGCCTCGCTCCTTCCGCTTCCAC
TTCAGAGGCACAGGATACGATGAGAAGATGGTGAGAGAGATGGAGGGCCTGGAAGCCTCGGGCTCCACGT
ATATCTGTACTCTGTGTGACTCCAGTCGGGCAGAGGCCTCTCAAAACATGGTGCTGCACTCCATCACCCG
CTCTCACGAAGAGAACCTGGAGCGTTACGAAATATGGAGAACCAACCCCTTCTCTGAGTCTGTGGAGGAG
CTGCGAGACAGAGTCAAAGGGGTCTCTGCGAAGCCCTTCATGGAGACCCAGCCCACACTTGATGCATTAC
ACTGTGACATTGGCAATGCCACAGAGTTCTACAAAATCTTCCAGGATGAGATNGGGGAGGTGTACCAAAA
GGTCAACCCCAGCCGAGAGGAGCGGCGCAGCTGGAGGGCAGCCCTAGATAAACAGCTGAGGAAGAAGATG
AAGCTTAAACCCATAATGAGGATGAATGGGAACTACGCCCGCAGGCTAATGACCCTGGAGGCTGTGGAGG
TGGTGTGCGAGCTGGTGCCCTCGGAGGAGAGGAGGGAGGCCCTGAGGGAGCTCATGAGGCTCTACCTCCA
GATGAGGCCTGTGTGGCGTGCCACCTGCCCAGCCAAGGAATGCCCCGACCAGCTGTGCCGCTACAGCTTC
AACTCCCAGCGCTTTGCTGACCTCCTATCCTCTACCTTCAAATATAGGTACAATGGAAAGATAACCAATT
ACCTTCACAAGACCCTGGCCCATGTGCCCGAAATCATAGAGAGGGATGGATCCATCGGAGCCTGGGCCAG
CGAGGGGAACGAGTCGGCGAACAAGCTGTTCAGGCGTTTCCGGAAGATGAATGC

Finding this in the genome, 1454 bp

(base) maccamp@farm:~/lates-wgs/genome$ blastn -query ../outputs/1209/EF095648.fasta -db GCF_001640805.2_TLL_Latcal_v3_genomic.fna -outfmt 6
EF095648.1	NC_066842.1	99.725	1454	4	0	1	1454	16653777	16655230	0.0	2665

checking GFF, aligns with annotation 

NC_066842.1	Gnomon	exon	16649976	16650208	.	+	.	ID=exon-XM_018663777.2-1;Parent=rna-XM_018663777.2;Dbxref=GeneID:108875106,GenBank:XM_018663777.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X1;transcript_id=XM_018663777.2
NC_066842.1	Gnomon	exon	16651233	16651589	.	+	.	ID=exon-XM_018663777.2-2;Parent=rna-XM_018663777.2;Dbxref=GeneID:108875106,GenBank:XM_018663777.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X1;transcript_id=XM_018663777.2
NC_066842.1	Gnomon	exon	16651683	16652815	.	+	.	ID=exon-XM_018663777.2-3;Parent=rna-XM_018663777.2;Dbxref=GeneID:108875106,GenBank:XM_018663777.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X1;transcript_id=XM_018663777.2
NC_066842.1	Gnomon	exon	16653664	16657032	.	+	.	ID=exon-XM_018663777.2-4;Parent=rna-XM_018663777.2;Dbxref=GeneID:108875106,GenBank:XM_018663777.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X1;transcript_id=XM_018663777.2
NC_066842.1	Gnomon	exon	16650215	16650405	.	+	.	ID=exon-XM_018663778.2-1;Parent=rna-XM_018663778.2;Dbxref=GeneID:108875106,GenBank:XM_018663778.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X2;transcript_id=XM_018663778.2
NC_066842.1	Gnomon	exon	16651233	16651589	.	+	.	ID=exon-XM_018663778.2-2;Parent=rna-XM_018663778.2;Dbxref=GeneID:108875106,GenBank:XM_018663778.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X2;transcript_id=XM_018663778.2
NC_066842.1	Gnomon	exon	16651683	16652815	.	+	.	ID=exon-XM_018663778.2-3;Parent=rna-XM_018663778.2;Dbxref=GeneID:108875106,GenBank:XM_018663778.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X2;transcript_id=XM_018663778.2
NC_066842.1	Gnomon	exon	16653664	16657032	.	+	.	ID=exon-XM_018663778.2-4;Parent=rna-XM_018663778.2;Dbxref=GeneID:108875106,GenBank:XM_018663778.2;experiment=COORDINATES: polyA evidence [ECO:0006239];gbkey=mRNA;gene=rag1;product=recombination activating 1%2C transcript variant X2;transcript_id=XM_018663778.2

So, we should filter THE vcf from 16653777-16655230 then convert to 

vcf: outputs/1204/plink-01.vcf.gz

Hmm or the whole thing


bcftools view -r NC_066842.1:16649976-16657032 ../1204/plink-01.vcf.gz > rag1.vcf
bcftools reheader --samples ../../bamlists/103-sample-names.txt rag1.vcf > rag1-renamed.vcf

bgzip rag1-renamed.vcf
tabix rag1-renamed.vcf.gz

bcftools view -r NC_066842.1 ../1204/plink-01.vcf.gz  > NC_066842.1.vcf 
bcftools reheader --samples ../../bamlists/103-sample-names.txt NC_066842.1.vcf > NC_066842.1-renamed.vcf
bgzip tabix

faults with examples, problem with GFF (line 381 or gtf)

(base) maccamp@farm:~/lates-wgs/outputs/1209$ samtools faidx ../../genome/GCF_001640805.2_TLL_Latcal_v3_genomic.fna NC_066842.1:16653777-16655230 > rag1-ref.fasta

error with alt/ref alleles ugh

trying gtf version

(base) maccamp@farm:~/lates-wgs/outputs/1209$ grep NC_066842.1 ../../genome/GCF_001640805.2_TLL_Latcal_v3_genomic.gtf > NC_066842.1.gtf
~/vcf2fasta/vcf2fasta.py --fasta NC_066842.1.fasta --gff rag1.gtf --vcf rag1-renamed.vcf.gz --feat CDS
~/vcf2fasta/vcf2fasta.py --fasta NC_066842.1.fasta --gff rag1.gtf --vcf rag1-renamed.vcf.gz --feat exon

runs, 8 exons


need phased data
module load openjdk/11.0.17_8       

impute then phase exon (sanger covers 16653777-16655230)
bcftools view -r NC_066842.1:16653664-16657032 rag1-renamed.vcf.gz > phylo.vcf

java -jar ~/bin/beagle.27Jan18.7e1.jar gt=phylo.vcf out=rag1-renamed-imputed

java -jar ~/bin/beagle.27Jan18.7e1.jar gt=rag1-renamed-imputed.vcf.gz out=rag1-phased ibd=true ibdcm=0.05

103 samples, 36 site
tabix rag1-phased.vcf.gz 

~/vcf2fasta/vcf2fasta.py --fasta NC_066842.1.fasta --gff rag1.gtf --vcf rag1-phased.vcf.gz --feat exon

Neat! Workign locally:

(base) ➜  1209 git:(main) ✗ cat rag1_exon_7.fas rag1-refs.fas > rag1.fas
mafft rag1.fas > rag1.afas      

iqtree2 -nt AUTO  -s rag1_exon_7.fas -st DNA -m GTR+G -bb 10000 --redo\

Interesting, only has 6 sites

iqtree2 -nt AUTO  -s test.afas -st DNA -m GTR+G -bb 10000 --redo

 

```{r}
data<-read.FASTA("outputs/1209/rag1_exon_7.fas")
write.nexus.data(data, file="outputs/1209/rag1_exon_7.nex")
```

(1) remove any individuals without calls

bcftools stats -s - phylo.vcf | grep -E ^PSC | cut -f3,14 | awk '{if ($2 == 0) print}' | cut -f 1 > no-missing.txt
(base) maccamp@farm:~/lates-wgs/outputs/1209$ bcftools view -S no-missing.txt phylo.vcf  > new.vcf

bcftools +fill-tags new.vcf.gz | bcftools view -i 'MAF > 0.05' > maf05.vcf

java -jar ~/bin/beagle.27Jan18.7e1.jar gt=maf05.vcf out=new-beagle

~/vcf2fasta/vcf2fasta.py --fasta NC_066842.1.fasta --gff rag1.gtf --vcf new-beagle.vcf.gz --feat exon

(base) ➜  1209 git:(main) ✗ scp farm:~/lates-wgs/outpus/1209/vcf2fasta_exon/rag1_exon_7.fas ./no-missing-7.fas

iqtree2 -nt AUTO  -s no-missing-7.afas  -st DNA -m GTR+G -bb 10000 --redo

Downsampling to a few samples (test-7)

iqtree2 -nt AUTO  -s test-7.afas -st DNA -m GTR+G -bb 10000 --redo

base) maccamp@farm:~/lates-wgs/outputs/1209$ bcftools view -r NC_066842.1:16653777-16655230 new.vcf.gz | bcftools +fill-tags | bcftools view -i 'MAF > 0.01' | grep -v "#"  | wc

14 variable sites

4 at .1

## Mtdna

in Li et al. 
  >HQ731431.1 Lates calcarifer voucher GO481 16S ribosomal RNA gene, partial sequence; mitochondrial
  AAGCAGAGATTAAACCTCGTACCTTTTGCATCATGACTTAGCTAGCACCCCCAAGCAAAGAGCATCTTTA
  GTTTGGCACCCCGAAACTAGTGTGAGCTACTCCAAGACAGCCTATTCAATAGGGCAAACCCGTCTCTGTG
  GCAAAAGAGTGGGAAGAGCTTTGAGTAGAGGTGACAGACCTACCGAACCTAGTTATAGCTGGTTGCCTGA
  GAACTGGATAGAAGTTCAGCCTCCCGGCTTCTCCATTCATATACTATTCCAATATGACTGCCCCCAGATC
  TAAAAGAAACCCGCGAGAGTTATTCTAAGGAGGTACAGCTCCTTTGAACCAAAATACAATTTTATAAGGA
  GGGTAAAGATCATAATCTTAACCAAGGCAGAATGTCCTAGTGGGCCTAAAAGCAGCCACCCCTTTCAGAA
  AGCGTTAAAGCTCAGACATACCTCTCCGCCCTATATCCCGATAATCTAATCTTAACCCCCTAGCCCTATC
  AGGCCGTTCCATGCAAACATGGAAGCGATAATGCTAACATGAGTAACAAGAGGATTTATTTTATCTGCGC
  TCCTCTCCCAGCACACGTGTACATCGAAACGGACCAACCACCGAAACTTAACGGCCCCAAACAAAGAGGG
  AATTGAAAGACAAACATGATATACTAGAAAATCATCCAGCACGCAACCGTTAACCCCACACTGGTGTGCC
  ATTAAAGGAAAGACTAAAAGAAAAAGAAGGAACTCGGCAAACACAAGCCTCGCCTGTTTACCAAAAACAT
  CGCCTCTTGTACAACCACATTAAAACAAATAAGAGGTCCCGCCTGCCCAGTGACAACTGGTTCAACGGCC
  GCGGTATTTTGACCGTGCAAAGGTAGCGTAATCACTTGTCTTTTAAATGAAGACCTGTATGAATGGCATC
  ACGAGGGCTTAGCTGTCTCCTTTTTCTAAGTCAGTGAAATTGATCTCCCCGTGCAGAAGCGGGGATAAAA
  ACATAAGACGAGAAGACCCTATGGAGCTTTAGACACCAGAATAGCACATGTTAAGACACCCTGAATAAAG
  AACTGAACTTAATGGCCCCCCTATTCCAATGTCTTCGGTTGGGGCGACCATGAGGAACAAAAACCCCTCA
  TGTGGAATGGGAGTACCACAACCCACACACTATTTTTCCTATACTCCTACAACCAAGAGCTACAACTCAA
  ACTGACAGAAATTCTGACCAACAATGATCCGGCAATGCTGATCAACGGACCAAGTTACCCTAGGGATAAC
  AGCGCAATCCCCTTTTAGAGCCCATATCGACAAGGGGGTTTACGACCTCGATGTTGGATCAGGACATCCT
  AATGGTGCAGCCG
  >HQ731403.1 Lates calcarifer voucher 79719B6.28 16S ribosomal RNA gene, partial sequence; mitochondrial
  AAGCAGAGATTAAACCTCGTACCTTTTGCATCATGACTTAGCTAGCACCCCCAAGCAAAGAGCACCTTTA
  GTTTGATACCCCGAAACTAGTGTGAGCTACTCCAAGACAGCCTATTCAATAGGGCAAACCCGTCTCTGTG
  GCAAAAGAGTGGGAAGAGCTTTGAGTAGAGGTGACAGACCTACCGAACTTAGTTATAGCTGGTTGCCTGA
  AAACTGGATAAAAGTTCAGCCTCCCGGCTTCTCCATTCATATACTATTCTAAACGACTACCCTTAGATCT
  AAAAGAAATCCGCGAGAGTTATTCTAAGGAGGTACAGCTCCTTTGAACCAAAATACAATTTTCTAAGGAG
  GGTAAAGATCATAATCTTAACCAAGGCAGAATGTCCTAGTGGGCCTAAAAGCAGCCACCCCCTTCAGAAA
  GCGTTAAAGCTCAGACATACCCCCCGCCCCATATTCCGATAACCTAATCTTAACCCCCTAACCCTATCAG
  GCCGTTCCATGCAGACATGGAAGCGACAATGCTAACATGAGTAATAAGAGGACTATACCAATCTGCGCTC
  CTCTCCTAGCACACGTGTATATCGAAACGGACCAACCACCGAAACTTAACGGCCCCAAACAAAGAGGGAA
  TTGAAAAACAAACATGATATACTAGAAAATCACCCAACACACAACCGTTAACCCCACACTGGTGTGCCAA
  AAGGAAAGACTAAAAGAAAAAGAAGGAACTCGGCAAACACAAGCCTCGCCTGTTTACCAAAAACATCGCC
  TCTTGTACAACCACATTAAAGCAAATAAGAGGTCCCGCCTGCCCAGTGACAACTGGTTCAACGGCCGCGG
  TATTTTGACCGTGCAAAGGTAGCGTAATCACTTGTCTTTTAAATGAAGACCTGTATGAATGGCATCACGA
  GGGCTTAACTGTCTCCTTTTTCTAAGTCAGTGAAATTGATCTCCCCGTGCAGAAGCGGGGATAAAAACAT
  AAGACGAGAAGACCCTATGGAGCTTTAGACACCAGAATAGCGCATGTTAAGACACCCTAAATAAAGGACT
  GAACTTAATGACCCCTCTATTCCAATGTCTTCGGTTGGGGCGACCATGAGGAACAAAAACCCCTCATGTG
  GAATGGGAGTACCACAACCCACACACTATTTTTCCTACACTCCTACAACCAAGAGCTACAACTCAAACTA
  ACAGAAATTCTGACCAACAATGATCCGGCAATACCGATCAACGGACCAAGTTACCCTAGGGATAACAGCG
  CAATCCCCTTTTAGAGCCCATATCGACAAGGGGGTTTACGACCTCGATGTTGGATCAGGACATCCTAATG
  GTGCAGCCGCTATTAAGGGTTC
  >HQ731402.1 Lates calcarifer voucher RP2001B10.78 16S ribosomal RNA gene, partial sequence; mitochondrial
  AAGCAGAGATTAAACCTCGTACCTTTTGCATCATGACTTAGCTAGCACCCCCAAGCAAAGAGCATCTTTA
  GTTTGGCACCCCGAAACTAGTGTGAGCTACTCCAAGACAGCCTATTCAATAGGGCAAACCCGTCTCTGTG
  GCAAAAGAGTGGGAAGAGCTTTGAGTAGAGGTGACAGACCTACCGAACCTAGTTATAGCTGGTTGCCTGA
  GAACTGGATAGAAGTTCAGCCTCCCGGCTTCTCCATTCATATACTATTCCAATATGACTGCCCCCAGATC
  TAGAAGAAACCCGCGAGAGTTATTCTAAGGAGGTACAGCTCCTTTGAACCAAAATACAATTTTATAAGGA
  GGGTAAAGATCATAATCTTAACCAAGGCAGAATGTCCTAGTGGGCCTAAAAGCAGCCACCCCTTTCAGAA
  AGCGTTAAAGCTCAGACATACCTCTCCGCCCTATATCCCGATAATCTAATCTTAACCCCCTAGCCCTATC
  AGGCCGTTCCATGCAAACATGGAAGCGATAATGCTAACATGAGTAACAAGAGGATTTATTTTATCTGCGC
  TCCTCTCCCAGCACACGTGTACATCGAAACGGACCAACCACCGAAACTTAACGGCCCCAAACAAAGAGGG
  AATTGAAAGACAAACATGATATACTAGAAAATCATCCAGCACGCAACCGTTAACCCCACACTGGTGTGCC
  ATTAAAGGAAAGACTAAAAGAAAAAGAAGGAACTCGGCAAACACAAGCCTCGCCTGTTTACCAAAAACAT
  CGCCTCTTGTACAACCACATTAAAACAAATAAGAGGTCCCGCCTGCCCAGTGACAACTGGTTCAACGGCC
  GCGGTATTTTGACCGTGCAAAGGTAGCGTAATCACTTGTCTTTTAAATGAAGACCTGTATGAATGGCATC
  ACGAGGGCTTAGCTGTCTCCTTTTTCTAAGTCAGTGAAATTGATCTCCCCGTGCAGAAGCGGGGATAAAA
  ACATAAGACGAGAAGACCCTATGGAGCTTTAGACACCAGAATAGCACATGTTAAGACACCCTGAATAAAG
  AACTGAACTTAATGGCCCCCCTATTCCAATGTCTTCGGTTGGGGCGACCATGAGGAACAAAAACCCCTCA
  TGTGGAATGGGAGTACCACAACCCACACACTATTTTTCCTATACTCCTACAACCAAGAGCTACAACTCAA
  ACTGACAGAAATTCTGACCAACAATGATCCGGCAATGCCGATCAACGGACCAAGTTACCCTAGGGATAAC
  AGCGCAATCCCCTTTTAGAGCCCATATCGACAAGGGGGTTTACGACCTCGATGTTGGATCAGGACATCCT
  AATGGTGCAGCCGCTATTAAGGGTTC

#These differ by 3-4 sites
>HQ731344.1 Lates calcarifer voucher GO481 pleiomorphic adenoma protein-like 2 (plagl2) gene, partial cds
CTGCAGACCCATGACCCCAACAAGGAGGCCTTCAAGTGTGAGGAGTGTGGGAAGCACTACAACACCAAGC
TGGGATACAAGCGCCATGTGGCCATGCACTCTGCCACAGCAGGGGATCTCACCTGTAAAGTGTGCATGCA
GACCTACGAGAGTACACCTGTTCTTTTGGAGCACCTCAAAAGCCACTCTGGGAAGTCTTCCGGTGGCGCC
AAGGAGAAGAAACACCCGTGTGACCACTGTGACCGTCGTTTCTACACACGGAAGGATGTGAGACGGCACA
TGGTGGTCCACACGGGCCGAAAGGACTTCCTGTGCCAGTACTGTGCCCAGCGCTTCGGCAGGAAGGACCA
CCTGACACGCCACGTGAAGAAGAGCCACTCGCAGGAGCTGCTGAAGATCAAGACGGAGCCTCCGGATATG
TTAGGCCTTTTAGCTTCTGGGTCACCACCTTGCTCTGTGAAGGAAGAGCTCAGCCCCATGATGTGCGGCA
TGGGTCCCAACAAAGACCCCATGATGGGCAAACCGTTCCCCAGTGGGGCCCCTTTTCCAATGGGCATGTA
CAACCCCCACCATCTTCAGGCAATGTCTAATACTGGGGTGGGTCACCCACACCCATCCCTAATGCCCAGT
TCCTTATCTGCAGCCATGGGCATGGGCTGTCACATGGAATCCCCTGGATCTCTTCACCCACACTCCCATC
>HQ731323.1 Lates calcarifer voucher 79719B6.28 pleiomorphic adenoma protein-like 2 (plagl2) gene, partial cds
CTGCAGACCCATGACCCCAACAAGGAGGCCTTCAAGTGTGAGGAGTGTGGGAAGCACTACAACACCAAGC
TGGGATACAAGCGCCATGTGGCCATGCACTCTGCCACAGCAGGGGATCTCACCTGTAAAGTGTGCATGCA
GAGCTACGAGAGTACACCTGTTCTTCTGGAGCATCTCAAAAGCCACTCTGGGAAGTCTTCCGGTGGTGCC
AAGGAGAAGAAACACCCGTGTGACCACTGTGACCGTCGTTTCTACACACGGAAGGATGTGAGACGGCACA
TGGTGGTCCACACGGGCCGAAAGGACTTCCTGTGCCAGTACTGTGCCCAGCGCTTCGGCAGGAAGGACCA
CCTGACACGCCACGTGAAGAAGAGCCACTCGCAGGAGCTGCTGAAGATCAAGACGGAGCCTCCGGATATG
TTAGGCCTTTTAGCTTCTGGGTCACCACCTTGCTCTGTGAAGGAAGAGCTCAGCCCCATGATGTGCGGCA
TGGGTCCCAACAAAGACCCCATGATGGGCAAACCGTTCCCCAGTGGGGCCCCTTTTCCAATGGGCATGTA
CAACCCCCACCATCTTCAGGCAATGTCTAATACTGGGGTGGGTCACCCACACCCATCCCTAATGCCCAGT
TCCTTATCTGCAGCCATGGGCATGGGCTGTCACATGGAATCCCCTGGATCTCTTCACCCACACTCCCATC
A
>HQ731322.1 Lates calcarifer voucher RP2001B10.78 pleiomorphic adenoma protein-like 2 (plagl2) gene, partial cds
CTGCAGACCCATGACCCCAACAAGGAGGCCTTCAAGTGTGAGGAGTGTGGGAAGCACTACAACACCAAGC
TGGGATACAAGCGCCATGTGGCCATGCACTCTGCCACAGCAGGGGATCTCACCTGTAAAGTGTGCATGCA
GAGCTACGAGAGTACACCTGTTCTTCTGGAGCATCTCAAAAGCCACTCTGGGAAGTCTTCCGGTGGCGCC
AAGGAGAAGAAACACCCGTGTGACCACTGTGACCGTCGTTTCTACACACGGAAGGATGTGAGACGGCACA
TGGTGGTCCACACGGGCCGAAAGGACTTCCTGTGCCAGTACTGTGCCCAGCGCTTCGGCAGGAAGGACCA
CCTGACACGCCACGTGAAGAAGAGCCACTCGCAGGAGCTGCTGAAGATCAAGACGGAGCCTCCGGATATG
TTAGGCCTTTTAGCTTCTGGGTCACCACCTTGCTCTGTGAAGGAAGAGCTCAGCCCCATGATGTGCGGCA
TGGGTCCCAACAAAGACCCCATGATGGGCAAACCGTTCCCCAGTGGGGCCCCTTTTCCAATGGGCATGTA
CAACCCCCACCATCTTCAGGCAATGTCTAATACTGGGGTGGGTCACCCACACCCATCCCTAATGCCCAGT
TCCTTATCTGCAGCCATGGGCATGGGCTGTCACATGGAATCCCCTGGATCTCTTCACCCACACTC

kiaa, one site
zinc finger? also highly conserved
si:dkey 1035/1040 sites, so more variable, also lots of other lates

>JQ937721.1 Lates calcarifer voucher GO481 si:dkey-174m14.3 (SIDKEY) gene, partial cds
GGTCAGAGGAAGCTACTGTATGGCCCCCAAAACTCTACCGACAGCAACCCAGAGGAGGGATCAGTTGGGT
TGACGGCCGGCTTCTCCCAGGAGCACTTTGCTAAGTTCCCCGCCACGCTGGGTGGAGGCTCCAGCTCCTA
CTCCAGCTTCAGTGGAGGGGGATCTGAGGACAAAGGCAACGGCCCACCCAGCAGTGTAGCTTCCTCCCCT
CGCCATCATTCCCTCTACATGGAGTGGAGAGATGCAGGGGACTATGAGCGAAAGAGTGACTCATCCTGGG
AGCGGGACAGTCCAAGAGGCTTTGCCAACGCTCATCCCTTCCAGCAGACGGAGCTGAGCCACCATCAGAA
CGGCAGTTCGCCCGTCTACAGCCGCACCATGTCCTCCTGCTTCAGTGAGCCCTATGAGCCGCTCCCTCCC
TCTTCATCCCCAAGTGTTGCCTATGGAGACAGTCGTCGAGGCAGCACATTAGCCCCCGAGGAGGAGGAGT
TGATTGGTCGATGGAGACAACTTAGCGTGGAGGACTTAAGTGCCCACACCTACCGTAGCCCAGGCCGGGC
TTCACCTTACAGCTTCTCAGAGCAGCACTTCTCTGTGCGGCCTGCTAAGATCCGACTCGGGCCACTCTAC
AGCAGCTTCCAGGAAGGAGCTGACTATTATCATCACGGAGCGGGTGCCATGGACCCGGTGTGGGTGGCCG
CCAGCCCAAGTCCCGAATGCAGCCCAGGGCTGCGGCAGGCGCACAGCCAAGCCCACCTCTACCGAGCTGA
GGACAGCCAGGGGTCGGAGCACAGCCTCTACCACTCAGGGAGCTCCAAAGACAGGGAGGGCAACGTGGCA
GCTGGTGGCCAGAGCACGGATTACGCAGACCCCAGCCCCAACAGCTCCACCGAGTCTCTCAACCAGAGGT
CCTTGGAGATGGCCGCGGAGCTGCAGCACTATCAAGTGGAGATGCACAGCTTGCCTGCGCAGGTGAACCA
GTCACCACCCCCGGCCCCACCCCCTCCTCCTCCGTACAACCAAAAATTTGGTTCCCTGGGACTTTCCAGA
>HQ731243.1 Lates calcarifer voucher RP2001B10.78 hypothetical protein gene, partial cds
GGTCAGAGGAAGCTACTGTATGGCCCCCAAAACTCTACCGACAGCAACCCAGAGGAGGGATCAGTTGGGT
TGACGGCCGGCTTCTCCCAGGAGCACTTTGCTAAGTTCCCCGCCACGCTGGGTGGAGGCTCCAGCTCCTA
CTCCAGCTTCAGTGGAGGGGGATCTGAGGACAAAGGCAACGGCCCACCCAGCAGTGTAGCTTCCTCCCCT
CGCCATCATTCCCTCTACATGGAGTGGAGAGATGCAGGGGACTATGAGCGAAAGAGTGACTCATCCTGGG
AGCGGGACAGTCCAAGAGGCTTTGCCAACGCTCATCCCTTCCAGCAGACGGAGCTGAGCCACCATCAGAA
CGGCAGTTCGCCCGTCTACAGCCGCACCATGTCCTCCTGCTTCAGTGAGCCCTATGAGCCGCTCCCTCCC
TCTTCATCCCCAAGTGTTGCCTATGGAGACAGTCGTCGAGGCAGCACATTAGCCCCCGAGGAGGAGGAGT
TGATTGGTCGATGGAGACAACTTAGCGTGGAGGACTTAAGTGCCCACACCTACCGTAGCCCAGGCCGGGC
TTCACCTTACAGCTTCTCAGAGCAGCACTTCTCTGTGCGGCCTGCTAAGATCCGACTCGGGCCACTCTAC
AGCAGCTTCCAGGAAGGAGCTGACTATTATCATCACGGAGCGGGTGCCATGGACCCGGTGTGGGTGGCCG
CCAGCCCAAGTCCCGAATGCAGCCCAGGGCTGCGGCAGGCGCACAGCCAAGCCCACCTCTACCGAGCTGA
GGACAGCCAGGGGTCGGAGCACAGCCTCTACCACTCAGGGAGCTCCAAAGACAGGGAGGGCAACGTGGCA
GCTGGTGGCCAGAGCACGGATTACGCAGACCCCAGCCCCAACAGCTCCACCGAGTCTCTCAACCAGAGGT
CCTTGGAGATGGCCGCGGAGCTGCAGCACTATCAAGTGGAGATGCACAGCTTGCCTGCGCAGGTGAACCA
GTCACCACCCCCGGCCCCACCCCCTCCTCCTCCGTACAACCAAAAATTTGGTTCCCTGGGACTTTCCAGA
AAGGACA
>HQ731244.1 Lates calcarifer voucher 79719B6.28 hypothetical protein gene, partial cds
AAGCTACTGTATGGCCCCCAAAACTCTACCGACAGCAACCCAGAGGAGGGATCAGTTGGGTTGACGGCCG
GCTTCTCCCAGGAGCACTTTGCTAAGTTCCCCGCCACGCTGGGTGGAGGCTCCAGCTCCTACTCCAGCTT
CAGTGGAGGGGGATCTGAGGACAAAGGCAACGGCCCACCCAGCAGTGTAGCTTCCTCCCCTCGCCATCAT
TCCCTCTACATGGAGTGGAGAGATGCAGGGGACTATGAGCGAAAGAGTGACTCATCCTGGGAGCGGGACA
GTCCAAGAGGCTTTGCCAACGCTCATCCCTTCCAGCAGACGGAGCTGAGCCACCACCAGAACGGCAGTTC
GCCCGTCTACAGCCGCACCATGTCCTCCTGCTTCAGTGAGCCCTATGAGCCGCTCCCTCCCTCTTCATCC
CCAAGTGTTGCCTATGGAGACAGTCGTCGAGGCAGCACATTAGCCCCCGAGGAGGAGGAGTTGATTGGTC
GATGGAGACAACTTAGCGTGGAGGACTTAAGTGCCCACACCTACCGTAGCCCAGGCCGGGCTTCACCTTA
CAGCTTCTCAGAGCAGCACTTCTCTGTGCGGCCTGCTAAGATCCGACTCGGGCCACTCTACAGCAGCTTC
CAGGAAGGAGCTGACTATTATCATCACGGAGCGGGTGCCATGGACCCGGTGTGGGTGGCCGCCAGCCCAA
GTCCCGAATGCAGCCCAGGGCTGCGGCAGGCCCACAGCCAAGCCCACCTCTACCGAGCTGAGGACAGCCA
GGGGTCGGAGCACAGCCTCTACCACTCAGGGAGCTCCAAAGACAGGGAGGGCAACGTGGCAGCTGGTGGC
CAGAGCACGGATTACGCAGACCCCAGCCCCAACAGCTCCACCGAGTCTCTCAACCAGAGGTCCTTGGAGA
TGGCCGCGGAGCTGCAGCACTATCAAGTGGAGATGCACAGCTTGCCTGCGCAGGGAAACCAGTCACCACC
CCCGGCCCCACCCCCTCCTCCTCCATACAACCAAAAATTTGGTTCCCTGGGACTTTCCAGGAAGGACA

JQ937721.1	NC_066839.1	100.000	1049	0	0	1	1049	7142520	7141472	0.0	1938
HQ731243.1	NC_066839.1	99.905	1057	1	0	1	1057	7142520	7141464	0.0	1947
HQ731244.1	NC_066839.1	99.523	1048	5	0	1	1048	7142511	7141464	0.0	1908


NC_066839.1
JQ937721.1	NC_066839.1	100.000	1049	0	0	1	1049	7142520	7141472	0.0	1938

si:dkey-174m14.3

7140508	7164609

bcftools view -r NC_066839.1:7140508-7164609 ../1204/plink-01.vcf.gz | bcftools +fill-tags | bcftools view -i 'MAF > 0.10' > sidkey.vcf
bcftools reheader --samples ../../bamlists/103-sample-names.txt sidkey.vcf > sidkey-renamed.vcf
bcftools stats -s - sidkey-renamed.vcf | grep -E ^PSC | cut -f3,14 | awk '{if ($2 <= 1) print}' | cut -f 1 > key-nomissing.txt

bcftools view -S key-nomissing.txt sidkey-renamed.vcf  > new-sidkey.vcf

java -jar ~/bin/beagle.27Jan18.7e1.jar gt=new-sidkey.vcf out=sidkey-imputed

~/vcf2fasta/vcf2fasta.py --fasta NC_066839.1.fasta --gff sidkey.gtf --vcf sidkey-imputed.vcf.gz --feat exon

                                                  7140508 7142835
this is exon 14


(base) ➜  1209 git:(main) ✗ scp farm:~/lates-wgs/outputs/1209/vcf2fasta_exon/si\:dkey-174m14.3_exon_14.fas ./sidkey.fas

iqtree2 -nt AUTO  -s sidkey.fas  -st DNA -m GTR+G -bb 10000 --redo


iqtree2 -nt AUTO  -s test-sidkey.afas  -st DNA -m GTR+G -bb 10000 --redo

The sidkey tree looks a lot better, but, then this is what we get from looking at some protein coding genes. Could just do the entire cds.